<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kaimail | Private Dashboard</title>
    <style>
        * { box-sizing: border-box; font-family: 'Arial', sans-serif; }
        body { margin: 0; display: flex; height: 100vh; background-color: #f6f8fc; overflow: hidden; }

        /* --- AUTH SCREEN --- */
        #auth-screen { position: fixed; inset: 0; background: #ffffff; display: flex; align-items: center; justify-content: center; z-index: 1000; }
        .auth-card { width: 350px; padding: 40px; border: 1px solid #ddd; border-radius: 12px; text-align: center; }
        .auth-card input { width: 100%; padding: 12px; margin-bottom: 10px; border: 1px solid #ccc; border-radius: 4px; }
        .auth-btn { width: 100%; padding: 12px; border: none; border-radius: 4px; cursor: pointer; font-weight: bold; margin-bottom: 5px; }
        .login-btn { background: #0b57d0; color: white; }
        .signup-btn { background: #f1f3f4; color: #444; }

        /* --- DASHBOARD --- */
        #main-dashboard { display: none; width: 100%; height: 100%; }
        .sidebar { width: 250px; padding: 20px; background: #f6f8fc; border-right: 1px solid #ddd; }
        .logo { font-size: 24px; font-weight: bold; color: #444; margin-bottom: 30px; }
        .nav-item { padding: 10px; cursor: pointer; border-radius: 20px; margin-bottom: 5px; color: #5f6368; }
        .nav-item.active { background: #d3e3fd; color: #041e49; font-weight: bold; }
        
        .content { flex: 1; padding: 20px; background: white; margin: 15px; border-radius: 16px; box-shadow: 0 1px 3px rgba(0,0,0,0.1); position: relative; }
        .user-bar { position: absolute; top: 15px; right: 20px; font-size: 13px; color: #555; }
        .logout-link { color: #d93025; cursor: pointer; text-decoration: underline; margin-left: 10px; }

        /* --- COMPOSER --- */
        .composer-box { position: fixed; bottom: 0; right: 80px; width: 500px; background: white; border-radius: 10px 10px 0 0; box-shadow: 0 8px 10px rgba(0,0,0,0.2); border: 1px solid #ccc; }
        .composer-header { background: #f2f6fc; padding: 10px; border-radius: 10px 10px 0 0; font-weight: bold; }
        form { display: flex; flex-direction: column; padding: 15px; }
        form input, form textarea { border: none; border-bottom: 1px solid #eee; padding: 10px; outline: none; }
        .send-btn { background: #0b57d0; color: white; border: none; padding: 10px 24px; border-radius: 20px; margin-top: 10px; cursor: pointer; width: fit-content; }
    </style>
</head>
<body>

    <div id="auth-screen">
        <div class="auth-card">
            <h1 style="color: #0b57d0; margin-bottom: 5px;">Kaimail</h1>
            <p style="margin-bottom: 25px;">Private Email Dashboard</p>
            <input type="email" id="user-email" placeholder="Email Address">
            <input type="password" id="user-pass" placeholder="Password">
            <button class="auth-btn login-btn" id="loginBtn">Sign In</button>
            <button class="auth-btn signup-btn" id="signupBtn">Create Account</button>
        </div>
    </div>

    <div id="main-dashboard">
        <div class="sidebar">
            <div class="logo">Kaimail</div>
            <div class="nav-item active">ðŸ“¥ Inbox</div>
            <div class="nav-item">ðŸ“¤ Sent</div>
        </div>

        <div class="content">
            <div class="user-bar">
                <span id="display-email"></span>
                <span class="logout-link" id="logoutBtn">Logout</span>
            </div>
            <h3>Inbox</h3>
            <div style="padding: 20px; border: 1px dashed #ccc; border-radius: 8px; color: #777;">
                Your kaimail.vercel.app inbox is empty.
            </div>
        </div>

        <div class="composer-box">
            <div class="composer-header">New Message</div>
            <form action="https://formspree.io/f/xdagdzag" method="POST">
                <input type="email" name="to" placeholder="Recipient" required>
                <input type="text" name="subject" placeholder="Subject">
                <textarea name="message" rows="8" placeholder="Message content..."></textarea>
                <input type="hidden" name="_next" value="https://kaimail.vercel.app">
                <button type="submit" class="send-btn">Send Email</button>
            </form>
        </div>
    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/12.8.0/firebase-app.js";
        import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/12.8.0/firebase-auth.js";

        const firebaseConfig = {
            apiKey: "AIzaSyBcuRlVYGdihgqLgG_qBakWX0Gjv1LVnqI",
            authDomain: "kaimail.firebaseapp.com",
            projectId: "kaimail",
            storageBucket: "kaimail.firebasestorage.app",
            messagingSenderId: "674907443966",
            appId: "1:674907443966:web:e4dfb78dbd9b228541cbaf"
        };

        // Initialize
        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);

        // UI Elements
        const emailInput = document.getElementById('user-email');
        const passInput = document.getElementById('user-pass');

        // Sign Up
        window.handleSignUp = () => {
            createUserWithEmailAndPassword(auth, emailInput.value, passInput.value)
                .catch(err => alert(err.message));
        };

        // Login
        window.handleLogin = () => {
            signInWithEmailAndPassword(auth, emailInput.value, passInput.value)
                .catch(err => alert(err.message));
        };

        // Logout
        window.handleLogout = () => signOut(auth);

        // Attach listeners
        document.getElementById('signupBtn').addEventListener('click', handleSignUp);
        document.getElementById('loginBtn').addEventListener('click', handleLogin);
        document.getElementById('logoutBtn').addEventListener('click', handleLogout);

        // Auth State Observer
        onAuthStateChanged(auth, (user) => {
            if (user) {
                document.getElementById('auth-screen').style.display = 'none';
                document.getElementById('main-dashboard').style.display = 'flex';
                document.getElementById('display-email').innerText = user.email;
            } else {
                document.getElementById('auth-screen').style.display = 'flex';
                document.getElementById('main-dashboard').style.display = 'none';
            }
        });
    </script>
</body>
</html>
